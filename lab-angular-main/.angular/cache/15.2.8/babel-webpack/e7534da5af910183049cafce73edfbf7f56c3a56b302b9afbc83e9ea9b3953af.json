{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/app/core/data.service\";\nimport * as i3 from \"src/app/core/auth.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nfunction ProductDetailComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 4);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r0.errorMessage);\n  }\n}\nfunction ProductDetailComponent_div_5_div_38_li_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const rating_r6 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate3(\" User \", rating_r6.userId, \": \", rating_r6.rating, \" stars - \\\"\", rating_r6.review, \"\\\" \");\n  }\n}\nfunction ProductDetailComponent_div_5_div_38_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"h3\");\n    i0.ɵɵtext(2, \"Reviews\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ul\");\n    i0.ɵɵtemplate(4, ProductDetailComponent_div_5_div_38_li_4_Template, 2, 3, \"li\", 12);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.product.ratings);\n  }\n}\nfunction ProductDetailComponent_div_5_option_45_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 13);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const i_r7 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", i_r7);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i_r7);\n  }\n}\nconst _c0 = function () {\n  return [1, 2, 3, 4, 5];\n};\nfunction ProductDetailComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"p\")(2, \"strong\");\n    i0.ɵɵtext(3, \"Name:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\")(6, \"strong\");\n    i0.ɵɵtext(7, \"Description:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"p\")(10, \"strong\");\n    i0.ɵɵtext(11, \"Manufacturer:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"p\")(14, \"strong\");\n    i0.ɵɵtext(15, \"Manufacturing Date:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"p\")(18, \"strong\");\n    i0.ɵɵtext(19, \"Price:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"p\")(22, \"strong\");\n    i0.ɵɵtext(23, \"Quantity:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(25, \"p\")(26, \"strong\");\n    i0.ɵɵtext(27, \"Category:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(28);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(29, \"p\")(30, \"strong\");\n    i0.ɵɵtext(31, \"Availability:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(32, \"span\", 5);\n    i0.ɵɵtext(33);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(34, \"p\")(35, \"strong\");\n    i0.ɵɵtext(36, \"Average Rating:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(37);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(38, ProductDetailComponent_div_5_div_38_Template, 5, 1, \"div\", 3);\n    i0.ɵɵelementStart(39, \"div\")(40, \"h3\");\n    i0.ɵɵtext(41, \"Add Rating\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(42, \"select\", 6);\n    i0.ɵɵlistener(\"ngModelChange\", function ProductDetailComponent_div_5_Template_select_ngModelChange_42_listener($event) {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.newRating = $event);\n    });\n    i0.ɵɵelementStart(43, \"option\", 7);\n    i0.ɵɵtext(44, \"Select Rating\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(45, ProductDetailComponent_div_5_option_45_Template, 2, 2, \"option\", 8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(46, \"textarea\", 9);\n    i0.ɵɵlistener(\"ngModelChange\", function ProductDetailComponent_div_5_Template_textarea_ngModelChange_46_listener($event) {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.newReview = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(47, \"button\", 10);\n    i0.ɵɵlistener(\"click\", function ProductDetailComponent_div_5_Template_button_click_47_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.submitRating());\n    });\n    i0.ɵɵtext(48, \"Submit\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(49, \"a\", 11);\n    i0.ɵɵtext(50, \"Back to Inventory\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.product.name, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.product.description, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.product.manufacturer, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.product.manufacturingDate, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.product.price, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.product.quantity, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.product.category || \"N/A\", \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngClass\", ctx_r1.getAvailabilityClass());\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r1.product.availabilityStatus);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.getAverageRating().toFixed(1), \" / 5\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.product.ratings == null ? null : ctx_r1.product.ratings.length);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.newRating);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpureFunction0(14, _c0));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.newReview);\n  }\n}\nfunction ProductDetailComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Loading...\");\n    i0.ɵɵelementEnd();\n  }\n}\nexport class ProductDetailComponent {\n  constructor(route, dataService, authService) {\n    this.route = route;\n    this.dataService = dataService;\n    this.authService = authService;\n    this.product = null;\n    this.errorMessage = null;\n    this.newRating = 0;\n    this.newReview = '';\n    this.userId = 0;\n  }\n  ngOnInit() {\n    const id = +this.route.snapshot.paramMap.get('id');\n    this.userId = this.getCurrentUserId();\n    this.dataService.getProductById(id).subscribe({\n      next: product => {\n        this.product = {\n          ...product,\n          availabilityStatus: this.getAvailabilityStatus(product.quantity) || 'Out of Stock'\n        };\n      },\n      error: err => this.errorMessage = err.message\n    });\n  }\n  getCurrentUserId() {\n    const user = JSON.parse(localStorage.getItem('user') || '{}');\n    return user.id || 0;\n  }\n  getAvailabilityStatus(quantity) {\n    if (quantity > 10) return 'In Stock';\n    if (quantity > 0) return 'Low Stock';\n    return 'Out of Stock';\n  }\n  submitRating() {\n    if (this.newRating >= 1 && this.newRating <= 5 && this.newReview && this.product) {\n      const ratingObj = {\n        rating: this.newRating,\n        review: this.newReview,\n        userId: this.userId\n      };\n      this.product.ratings = this.product.ratings || [];\n      this.product.ratings.push(ratingObj);\n      this.dataService.updateProduct(this.product).subscribe({\n        next: () => {\n          this.newRating = 0;\n          this.newReview = '';\n          alert('Rating and review submitted successfully!');\n        },\n        error: err => this.errorMessage = err.message\n      });\n    } else {\n      this.errorMessage = 'Please select a rating (1-5) and provide a review.';\n    }\n  }\n  getAverageRating() {\n    if (!this.product?.ratings?.length) return 0;\n    return this.product.ratings.reduce((sum, r) => sum + r.rating, 0) / this.product.ratings.length;\n  }\n  getAvailabilityClass() {\n    return this.product?.availabilityStatus?.toLowerCase().replace(' ', '-') || 'out-of-stock';\n  }\n}\nProductDetailComponent.ɵfac = function ProductDetailComponent_Factory(t) {\n  return new (t || ProductDetailComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.DataService), i0.ɵɵdirectiveInject(i3.AuthService));\n};\nProductDetailComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ProductDetailComponent,\n  selectors: [[\"app-product-detail\"]],\n  decls: 7,\n  vars: 3,\n  consts: [[1, \"container\"], [1, \"card\"], [\"class\", \"error-message\", 4, \"ngIf\"], [4, \"ngIf\"], [1, \"error-message\"], [3, \"ngClass\"], [3, \"ngModel\", \"ngModelChange\"], [\"value\", \"0\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"placeholder\", \"Write a review\", 3, \"ngModel\", \"ngModelChange\"], [3, \"click\"], [\"routerLink\", \"/inventory\"], [4, \"ngFor\", \"ngForOf\"], [3, \"value\"]],\n  template: function ProductDetailComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h2\");\n      i0.ɵɵtext(3, \"Product Details\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(4, ProductDetailComponent_div_4_Template, 2, 1, \"div\", 2);\n      i0.ɵɵtemplate(5, ProductDetailComponent_div_5_Template, 51, 15, \"div\", 3);\n      i0.ɵɵtemplate(6, ProductDetailComponent_div_6_Template, 2, 0, \"div\", 3);\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngIf\", ctx.errorMessage);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.product);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.product && !ctx.errorMessage);\n    }\n  },\n  dependencies: [i4.NgClass, i4.NgForOf, i4.NgIf, i5.NgSelectOption, i5.ɵNgSelectMultipleOption, i5.DefaultValueAccessor, i5.SelectControlValueAccessor, i5.NgControlStatus, i5.NgModel, i1.RouterLink],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":";;;;;;;;IAGIA,8BAAgD;IAAAA,YAAkB;IAAAA,iBAAM;;;;IAAxBA,eAAkB;IAAlBA,yCAAkB;;;;;IAc5DA,0BAA2C;IACzCA,YACF;IAAAA,iBAAK;;;;IADHA,eACF;IADEA,iHACF;;;;;IALJA,2BAAqC;IAC/BA,uBAAO;IAAAA,iBAAK;IAChBA,0BAAI;IACFA,mFAEK;IACPA,iBAAK;;;;IAHoBA,eAAkB;IAAlBA,gDAAkB;;;;;IASzCA,kCAAsD;IAAAA,YAAO;IAAAA,iBAAS;;;;IAA5BA,4BAAW;IAACA,eAAO;IAAPA,0BAAO;;;;;;;;;IAtBnEA,2BAAqB;IACRA,qBAAK;IAAAA,iBAAS;IAACA,YAAkB;IAAAA,iBAAI;IAChDA,yBAAG;IAAQA,4BAAY;IAAAA,iBAAS;IAACA,YAAyB;IAAAA,iBAAI;IAC9DA,yBAAG;IAAQA,8BAAa;IAAAA,iBAAS;IAACA,aAA0B;IAAAA,iBAAI;IAChEA,0BAAG;IAAQA,oCAAmB;IAAAA,iBAAS;IAACA,aAA+B;IAAAA,iBAAI;IAC3EA,0BAAG;IAAQA,uBAAM;IAAAA,iBAAS;IAACA,aAAmB;IAAAA,iBAAI;IAClDA,0BAAG;IAAQA,0BAAS;IAAAA,iBAAS;IAACA,aAAsB;IAAAA,iBAAI;IACxDA,0BAAG;IAAQA,0BAAS;IAAAA,iBAAS;IAACA,aAA+B;IAAAA,iBAAI;IACjEA,0BAAG;IAAQA,8BAAa;IAAAA,iBAAS;IAACA,gCAAyC;IAAAA,aAAgC;IAAAA,iBAAO;IAClHA,0BAAG;IAAQA,gCAAe;IAAAA,iBAAS;IAACA,aAAuC;IAAAA,iBAAI;IAC/EA,+EAOM;IACNA,4BAAK;IACCA,2BAAU;IAAAA,iBAAK;IACnBA,kCAAgC;IAAxBA;MAAAA;MAAA;MAAA;IAAA,EAAuB;IAC7BA,kCAAkB;IAAAA,8BAAa;IAAAA,iBAAS;IACxCA,qFAAsE;IACxEA,iBAAS;IACTA,oCAA+D;IAArDA;MAAAA;MAAA;MAAA;IAAA,EAAuB;IAA8BA,iBAAW;IAC1EA,mCAAiC;IAAzBA;MAAAA;MAAA;MAAA,OAASA,qCAAc;IAAA,EAAC;IAACA,uBAAM;IAAAA,iBAAS;IAElDA,8BAA2B;IAAAA,kCAAiB;IAAAA,iBAAI;;;;IA1BtBA,eAAkB;IAAlBA,mDAAkB;IACXA,eAAyB;IAAzBA,0DAAyB;IACxBA,eAA0B;IAA1BA,2DAA0B;IACpBA,eAA+B;IAA/BA,gEAA+B;IAC5CA,eAAmB;IAAnBA,oDAAmB;IAChBA,eAAsB;IAAtBA,uDAAsB;IACtBA,eAA+B;IAA/BA,gEAA+B;IACrBA,eAAkC;IAAlCA,uDAAkC;IAACA,eAAgC;IAAhCA,uDAAgC;IACvEA,eAAuC;IAAvCA,wEAAuC;IACrEA,eAA6B;IAA7BA,4FAA6B;IAUzBA,eAAuB;IAAvBA,0CAAuB;IAEPA,eAAkB;IAAlBA,qDAAkB;IAEhCA,eAAuB;IAAvBA,0CAAuB;;;;;IAKrCA,2BAAuC;IAAAA,0BAAU;IAAAA,iBAAM;;;ACtB3D,OAAM,MAAOC,sBAAsB;EAOjCC,YACUC,KAAqB,EACrBC,WAAwB,EACxBC,WAAwB;IAFxB,UAAK,GAALF,KAAK;IACL,gBAAW,GAAXC,WAAW;IACX,gBAAW,GAAXC,WAAW;IATrB,YAAO,GAAmB,IAAI;IAC9B,iBAAY,GAAkB,IAAI;IAClC,cAAS,GAAW,CAAC;IACrB,cAAS,GAAW,EAAE;IACtB,WAAM,GAAW,CAAC;EAMf;EAEHC,QAAQ;IACN,MAAMC,EAAE,GAAG,CAAC,IAAI,CAACJ,KAAK,CAACK,QAAQ,CAACC,QAAQ,CAACC,GAAG,CAAC,IAAI,CAAE;IACnD,IAAI,CAACC,MAAM,GAAG,IAAI,CAACC,gBAAgB,EAAE;IACrC,IAAI,CAACR,WAAW,CAACS,cAAc,CAACN,EAAE,CAAC,CAACO,SAAS,CAAC;MAC5CC,IAAI,EAAGC,OAAgB,IAAI;QACzB,IAAI,CAACA,OAAO,GAAG;UACb,GAAGA,OAAO;UACVC,kBAAkB,EAAE,IAAI,CAACC,qBAAqB,CAACF,OAAO,CAACG,QAAQ,CAAC,IAAI;SACrE;MACH,CAAC;MACDC,KAAK,EAAGC,GAAU,IAAK,IAAI,CAACC,YAAY,GAAGD,GAAG,CAACE;KAChD,CAAC;EACJ;EAEAX,gBAAgB;IACd,MAAMY,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,IAAI,IAAI,CAAC;IAC7D,OAAOJ,IAAI,CAACjB,EAAE,IAAI,CAAC;EACrB;EAEAW,qBAAqB,CAACC,QAAgB;IACpC,IAAIA,QAAQ,GAAG,EAAE,EAAE,OAAO,UAAU;IACpC,IAAIA,QAAQ,GAAG,CAAC,EAAE,OAAO,WAAW;IACpC,OAAO,cAAc;EACvB;EAEAU,YAAY;IACV,IAAI,IAAI,CAACC,SAAS,IAAI,CAAC,IAAI,IAAI,CAACA,SAAS,IAAI,CAAC,IAAI,IAAI,CAACC,SAAS,IAAI,IAAI,CAACf,OAAO,EAAE;MAChF,MAAMgB,SAAS,GAAG;QAAEC,MAAM,EAAE,IAAI,CAACH,SAAS;QAAEI,MAAM,EAAE,IAAI,CAACH,SAAS;QAAEpB,MAAM,EAAE,IAAI,CAACA;MAAM,CAAE;MACzF,IAAI,CAACK,OAAO,CAACmB,OAAO,GAAG,IAAI,CAACnB,OAAO,CAACmB,OAAO,IAAI,EAAE;MACjD,IAAI,CAACnB,OAAO,CAACmB,OAAO,CAACC,IAAI,CAACJ,SAAS,CAAC;MACpC,IAAI,CAAC5B,WAAW,CAACiC,aAAa,CAAC,IAAI,CAACrB,OAAO,CAAC,CAACF,SAAS,CAAC;QACrDC,IAAI,EAAE,MAAK;UACT,IAAI,CAACe,SAAS,GAAG,CAAC;UAClB,IAAI,CAACC,SAAS,GAAG,EAAE;UACnBO,KAAK,CAAC,2CAA2C,CAAC;QACpD,CAAC;QACDlB,KAAK,EAAGC,GAAU,IAAK,IAAI,CAACC,YAAY,GAAGD,GAAG,CAACE;OAChD,CAAC;KACH,MAAM;MACL,IAAI,CAACD,YAAY,GAAG,oDAAoD;;EAE5E;EAEAiB,gBAAgB;IACd,IAAI,CAAC,IAAI,CAACvB,OAAO,EAAEmB,OAAO,EAAEK,MAAM,EAAE,OAAO,CAAC;IAC5C,OAAO,IAAI,CAACxB,OAAO,CAACmB,OAAO,CAACM,MAAM,CAAC,CAACC,GAAG,EAAEC,CAAC,KAAKD,GAAG,GAAGC,CAAC,CAACV,MAAM,EAAE,CAAC,CAAC,GAAG,IAAI,CAACjB,OAAO,CAACmB,OAAO,CAACK,MAAM;EACjG;EAEAI,oBAAoB;IAClB,OAAO,IAAI,CAAC5B,OAAO,EAAEC,kBAAkB,EAAE4B,WAAW,EAAE,CAACC,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,IAAI,cAAc;EAC5F;;AA/DW7C,sBAAsB;mBAAtBA,sBAAsB;AAAA;AAAtBA,sBAAsB;QAAtBA,sBAAsB;EAAA8C;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MDXnCnD,8BAAuB;MAEfA,+BAAe;MAAAA,iBAAK;MACxBA,uEAAwE;MACxEA,yEA4BM;MACNA,uEAAuD;MACzDA,iBAAM;;;MA/BEA,eAAkB;MAAlBA,uCAAkB;MAClBA,eAAa;MAAbA,kCAAa;MA6BbA,eAA+B;MAA/BA,wDAA+B","names":["i0","ProductDetailComponent","constructor","route","dataService","authService","ngOnInit","id","snapshot","paramMap","get","userId","getCurrentUserId","getProductById","subscribe","next","product","availabilityStatus","getAvailabilityStatus","quantity","error","err","errorMessage","message","user","JSON","parse","localStorage","getItem","submitRating","newRating","newReview","ratingObj","rating","review","ratings","push","updateProduct","alert","getAverageRating","length","reduce","sum","r","getAvailabilityClass","toLowerCase","replace","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\malik\\Downloads\\Evaluation\\lab-angular-main\\src\\app\\features\\inventory\\product-detail\\product-detail.component.html","C:\\Users\\malik\\Downloads\\Evaluation\\lab-angular-main\\src\\app\\features\\inventory\\product-detail\\product-detail.component.ts"],"sourcesContent":["<div class=\"container\">\r\n  <div class=\"card\">\r\n    <h2>Product Details</h2>\r\n    <div *ngIf=\"errorMessage\" class=\"error-message\">{{ errorMessage }}</div>\r\n    <div *ngIf=\"product\">\r\n      <p><strong>Name:</strong> {{ product.name }}</p>\r\n      <p><strong>Description:</strong> {{ product.description }}</p>\r\n      <p><strong>Manufacturer:</strong> {{ product.manufacturer }}</p>\r\n      <p><strong>Manufacturing Date:</strong> {{ product.manufacturingDate }}</p>\r\n      <p><strong>Price:</strong> {{ product.price }}</p>\r\n      <p><strong>Quantity:</strong> {{ product.quantity }}</p>\r\n      <p><strong>Category:</strong> {{ product.category || 'N/A' }}</p>\r\n      <p><strong>Availability:</strong> <span [ngClass]=\"getAvailabilityClass()\">{{ product.availabilityStatus }}</span></p>\r\n      <p><strong>Average Rating:</strong> {{ getAverageRating().toFixed(1) }} / 5</p>\r\n      <div *ngIf=\"product.ratings?.length\">\r\n        <h3>Reviews</h3>\r\n        <ul>\r\n          <li *ngFor=\"let rating of product.ratings\">\r\n            User {{ rating.userId }}: {{ rating.rating }} stars - \"{{ rating.review }}\"\r\n          </li>\r\n        </ul>\r\n      </div>\r\n      <div>\r\n        <h3>Add Rating</h3>\r\n        <select [(ngModel)]=\"newRating\">\r\n          <option value=\"0\">Select Rating</option>\r\n          <option *ngFor=\"let i of [1, 2, 3, 4, 5]\" [value]=\"i\">{{ i }}</option>\r\n        </select>\r\n        <textarea [(ngModel)]=\"newReview\" placeholder=\"Write a review\"></textarea>\r\n        <button (click)=\"submitRating()\">Submit</button>\r\n      </div>\r\n      <a routerLink=\"/inventory\">Back to Inventory</a>\r\n    </div>\r\n    <div *ngIf=\"!product && !errorMessage\">Loading...</div>\r\n  </div>\r\n</div>","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { DataService } from 'src/app/core/data.service';\nimport { Product } from 'src/app/shared/models/product.mode';\nimport { AuthService } from 'src/app/core/auth.service';\n\n@Component({\n  selector: 'app-product-detail',\n  templateUrl: './product-detail.component.html',\n  styleUrls: ['./product-detail.component.css']\n})\nexport class ProductDetailComponent implements OnInit {\n  product: Product | null = null;\n  errorMessage: string | null = null;\n  newRating: number = 0;\n  newReview: string = '';\n  userId: number = 0;\n\n  constructor(\n    private route: ActivatedRoute,\n    private dataService: DataService,\n    private authService: AuthService\n  ) {}\n\n  ngOnInit(): void {\n    const id = +this.route.snapshot.paramMap.get('id')!;\n    this.userId = this.getCurrentUserId();\n    this.dataService.getProductById(id).subscribe({\n      next: (product: Product) => {\n        this.product = {\n          ...product,\n          availabilityStatus: this.getAvailabilityStatus(product.quantity) || 'Out of Stock'\n        };\n      },\n      error: (err: Error) => this.errorMessage = err.message\n    });\n  }\n\n  getCurrentUserId(): number {\n    const user = JSON.parse(localStorage.getItem('user') || '{}');\n    return user.id || 0;\n  }\n\n  getAvailabilityStatus(quantity: number): string {\n    if (quantity > 10) return 'In Stock';\n    if (quantity > 0) return 'Low Stock';\n    return 'Out of Stock';\n  }\n\n  submitRating(): void {\n    if (this.newRating >= 1 && this.newRating <= 5 && this.newReview && this.product) {\n      const ratingObj = { rating: this.newRating, review: this.newReview, userId: this.userId };\n      this.product.ratings = this.product.ratings || [];\n      this.product.ratings.push(ratingObj);\n      this.dataService.updateProduct(this.product).subscribe({\n        next: () => {\n          this.newRating = 0;\n          this.newReview = '';\n          alert('Rating and review submitted successfully!');\n        },\n        error: (err: Error) => this.errorMessage = err.message\n      });\n    } else {\n      this.errorMessage = 'Please select a rating (1-5) and provide a review.';\n    }\n  }\n\n  getAverageRating(): number {\n    if (!this.product?.ratings?.length) return 0;\n    return this.product.ratings.reduce((sum, r) => sum + r.rating, 0) / this.product.ratings.length;\n  }\n\n  getAvailabilityClass(): string {\n    return this.product?.availabilityStatus?.toLowerCase().replace(' ', '-') || 'out-of-stock';\n  }\n}"]},"metadata":{},"sourceType":"module","externalDependencies":[]}